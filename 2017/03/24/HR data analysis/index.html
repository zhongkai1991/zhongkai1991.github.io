<!DOCTYPE html>
<html lang=en>
<head>
    <meta name="google-site-verification" content="_8proO-_Uub02nww6yk8D8fmOiSnWxhO2AWXXrmMe0U" />
    <meta charset="utf-8">
    
    <title>HR data analysis | Stat World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="This dataset aims to understand why some of the best or most experienced employees are leaving. The company want to detect the most influencial factor that can help us predict whether valuable employe">
<meta property="og:type" content="article">
<meta property="og:title" content="HR data analysis">
<meta property="og:url" content="http://zhongkai1991.github.io/2017/03/24/HR data analysis/index.html">
<meta property="og:site_name" content="Stat World">
<meta property="og:description" content="This dataset aims to understand why some of the best or most experienced employees are leaving. The company want to detect the most influencial factor that can help us predict whether valuable employe">
<meta property="og:image" content="http://zhongkai1991.github.io/images/giphy2.gif">
<meta property="og:updated_time" content="2017-04-25T03:43:10.328Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HR data analysis">
<meta name="twitter:description" content="This dataset aims to understand why some of the best or most experienced employees are leaving. The company want to detect the most influencial factor that can help us predict whether valuable employe">
<meta name="twitter:image" content="http://zhongkai1991.github.io/images/giphy2.gif">
    

    
        <link rel="alternate" href="/" title="Stat World" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96175932-1', 'auto');
  ga('send', 'pageview');

</script>

    
    
        <meta name="google-site-verification" content="_8proO-_Uub02nww6yk8D8fmOiSnWxhO2AWXXrmMe0U" />
    
    
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?38b7604cf2ba9f54884e4e030e159b08";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Stat World</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.png" />
            <h2 id="name">Kai Zhong</h2>
            <h3 id="title">Data Analyst</h3>
            <span id="location"><i class="fa fa-map-marker"></i>New York,USA</span>
            <a id="follow" target="_blank" href="https://github.com/zhongkai1991/">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                4
                <span>posts</span>
            </div>
            <div class="article-info-block">
                4
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://github.com/zhongkai1991/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://www.linkedin.com/in/kai-zhong-aaa178a2/" target="_blank" title="linkedin" class=tooltip>
                            <i class="fa fa-linkedin"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://www.facebook.com/profile.php?id=100012556470897" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-HR data analysis" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            
	
		<img src="/images/giphy2.gif" class="article-banner" />
	



        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            HR data analysis
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/03/24/HR data analysis/">
            <time datetime="2017-03-23T23:48:16.409Z" itemprop="datePublished">2017-03-24</time>
        </a>
    </div>


                        
                        
                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>This dataset aims to understand why some of the best or most experienced employees are leaving. The company want to detect the most influencial factor that can help us predict whether valuable employees will leave or not.<br><a id="more"></a></p>
<h2 id="Analytical-procedure"><a href="#Analytical-procedure" class="headerlink" title="Analytical procedure"></a>Analytical procedure</h2><p>Firstly, we need to explain why valuable employees leave, and secondly, we want to predict who will leave next.<br>Therefore, we propose to work with the HR department to gather relevant data about the employees and to communicate the significant effect that could explain and predict employees’ departure.</p>
<h2 id="Measurement-and-method"><a href="#Measurement-and-method" class="headerlink" title="Measurement and method"></a>Measurement and method</h2><p>We have several indexes to measure our nearly 15 000 employees’ working condition. They are satisfaction level, latest evaluation (yearly), number of project worked on, average monthly hours, time spend in the company (in years), work accident (within the past 2 years), promotion within the past 5 years, department and salary.</p>
<p><br><br><br></p>
<h2 id="Exploratory-analysis"><a href="#Exploratory-analysis" class="headerlink" title="Exploratory analysis"></a>Exploratory analysis</h2><p>This dataset is from the HR department: (it doesn’t take into account<br>the person that have been fired, transferred or hired in the past year.)</p>
<h2 id="Data-cleaning-stage"><a href="#Data-cleaning-stage" class="headerlink" title="Data cleaning stage"></a>Data cleaning stage</h2><p>At this stage we want to need to check and clean data in order to improve the quality of our analysis.</p>
<h2 id="Data-quality-report"><a href="#Data-quality-report" class="headerlink" title="Data quality report"></a>Data quality report</h2><p>This table describes the characteristics of each features of our ABT. We<br>can see different statistical measures of central tendency and<br>variation.</p>
<pre><code># Correct variables&apos; attributes
data$work_accid=as.factor(data$work_accid)
data$promo_last_5yrs=as.factor(data$promo_last_5yrs)
data$left_or_not=as.factor(data$left_or_not)
data$department=as.factor(data$department)
data$salary=as.factor(data$salary)
str(data) 
</code></pre><table>
<thead>
<tr>
<th>variable</th>
<th>14999 obs. of  10 variables</th>
</tr>
</thead>
<tbody>
<tr>
<td>satisf_level</td>
<td>num  0.38 0.8 0.11 0.72 0.37 0.41 0.1 0.92 0.89   0.42 …</td>
</tr>
<tr>
<td>last_eval</td>
<td>num  0.53 0.86 0.88 0.87 0.52 0.5 0.77 0.85 1   0.53 …</td>
</tr>
<tr>
<td>num_proj</td>
<td>int  2 5 7 5 2 2 6 5 5 2 …</td>
</tr>
<tr>
<td>ave_mon_hrs</td>
<td>int  157 262 272 223 159 153 247 259 224 142 …</td>
</tr>
<tr>
<td>time_spend</td>
<td>int  3 6 4 5 3 3 4 5 5 3 …</td>
</tr>
<tr>
<td>work_accid</td>
<td>Factor w/ 2 levels   “0”,”1”: 1 1 1 1 1 1 1 1 1 1 …</td>
</tr>
<tr>
<td>promo_last_5yrs</td>
<td>Factor w/ 2 levels   “0”,”1”: 1 1 1 1 1 1 1 1 1 1 …</td>
</tr>
<tr>
<td>department</td>
<td>Factor w/ 10 levels   “accounting”,”hr”,..: 8 8 8 8 8 8 8 8 8 8 …</td>
</tr>
<tr>
<td>salary</td>
<td>Factor w/ 3 levels   “high”,”low”,”medium”: 2 3 3 2 2 2 2 2 2 2 …</td>
</tr>
<tr>
<td>left_or_not</td>
<td>Factor w/ 2 levels   “0”,”1”: 2 2 2 2 2 2 2 2 2 2 …</td>
</tr>
</tbody>
</table>
<pre><code># Finding NA
which(is.na(data), arr.ind=TRUE) #the indices of NA values
row col
</code></pre><p><br></p>
<p><hr><br><br></p>
<h2 id="First-visualisations"><a href="#First-visualisations" class="headerlink" title="First visualisations"></a>First visualisations</h2><p>In this part, we will see several plots indicating the relationship between several working conditions and the result who left.<br>On average people who leave have a low satisfaction level, they work<br>more and didn’t get promoted within the past five years.</p>
<p><br></p>
<h2 id="Who-is-leaving"><a href="#Who-is-leaving" class="headerlink" title="Who is leaving?"></a>Who is leaving?</h2><p>Let’s create a data frame with only the people that have left the<br>company, so we can visualise what is the distribution of each features:</p>
<pre><code>#Data Exploration (Quantitative Explanotary Variables vs. Qualitative Binary Response Variable)
#Making table
t_bygroup=function(d, x, y, n){
  # an elegant way to install a missing package
  if (!require(&quot;plyr&quot;)) install.packages(&quot;plyr&quot;)
  t &lt;- ddply(d, y, .fun = function(dd){
    c(Mean = mean(dd[,x],na.rm=TRUE),
      Sd = sd(dd[,x],na.rm=TRUE),
      min=min(dd[,x]), 
      Q1=quantile(dd[,x],0.25),
      Median=quantile(dd[,x],0.5),
      Q3=quantile(dd[,x],0.75), 
      Max=max(dd[,x])) })
  return(t)
}

#making histogram
hist_bygroup=function(d,xx,yy,name){
  if (!require(&quot;ggplot2&quot;)) install.packages(&quot;ggplot2&quot;)
  ggplot(d, aes_string(x=xx, color=yy, fill=yy))+ 
    geom_histogram(aes(y=..density..), alpha=0.5, 
                   position=&quot;identity&quot;)+
    geom_density(alpha=.3)+
    ggtitle(name)  
}

#making boxplot
box_bygroup=function(d,xx,yy,name){
  if (!require(&quot;ggplot2&quot;)) install.packages(&quot;ggplot2&quot;)
  ggplot(d, aes_string(x=yy, y=xx, fill=yy)) + 
    geom_boxplot()+
    ggtitle(name) 
}

if (!require(&quot;Rmisc&quot;)) install.packages(&quot;Rmisc&quot;) # Arrangement for multiple ggplots
</code></pre><p>the next step is to make a combination of both</p>
<pre><code># Histogram and box plot
library(Rmisc)
hist_sat=hist_bygroup(d=data, xx=&quot;satisf_level&quot;, yy=&quot;left_or_not&quot;,
                      &quot;Histogram for satisf_level&quot;)
box_sat=box_bygroup(d=data, xx=&quot;satisf_level&quot;, yy=&quot;left_or_not&quot;,
                    &quot;Boxplot for satisf_level&quot;)
multiplot(plotlist = list(hist_sat,box_sat), cols = 2) 
</code></pre><p><img src="http://i.imgur.com/KL7CtZ9.png" alt="plot 1"><br>    hist_le=hist_bygroup(d=data, xx=”last_eval”, yy=”left_or_not”,”Histogram for last_eval”)<br>    box_le=box_bygroup(d=data, xx=”last_eval”, yy=”left_or_not”,”Boxplot for last_eval”)<br>    multiplot(plotlist = list(hist_le,box_le), cols = 2)<br><img src="/2017/03/24/HR data analysis/HR data/Rplotlast_eval.png" alt="plot 2"><br>    hist_np=hist_bygroup(d=data, xx=”num_proj”, yy=”left_or_not”,”Histogram for num_proj”)<br>    box_np=box_bygroup(d=data, xx=”num_proj”, yy=”left_or_not”,”Boxplot for num_proj”)<br>    multiplot(plotlist = list(hist_np,box_np), cols = 2)<br><img src="/2017/03/24/HR data analysis/HR data/Rplotnp.png" alt="plot 3"><br>    histamh=hist_bygroup(d=data, xx=”ave_mon_hrs”, yy=”left_or_not”,”Histogram for ave_mon_hrs”)<br>    boxamh=box_bygroup(d=data, xx=”ave_mon_hrs”, yy=”left_or_not”,”Boxplot for ave_mon_hrs”)<br>    multiplot(plotlist = list(histamh,boxamh), cols = 2)<br><img src="/2017/03/24/HR data analysis/HR data/Rplotamh.png" alt="plot 4"><br>    hist_ts=hist_bygroup(d=data, xx=”time_spend”, yy=”left_or_not”,”Histogram for time_spend”)<br>    box_ts=box_bygroup(d=data, xx=”time_spend”, yy=”left_or_not”,”Boxplot for time_spend”)<br>    multiplot(plotlist = list(hist_ts,box_ts), cols = 2)<br><img src="/2017/03/24/HR data analysis/HR data/Rplotts.png" alt="plot 5"></p>
<pre><code># Data Exploration (Qualitative Explanotary Variables vs. Qualitative Binary Response Variable)
leave_or_not &lt;- factor(data$left_or_not,labels = c(&quot;stay&quot;,&quot;leave&quot;))
workaccident&lt;- factor(data$work_accid,labels = c(&quot;never happened&quot;, &quot;happened&quot;))
promotion &lt;- factor(data$promo_last_5yrs,labels = c(&quot;not promoted&quot;, &quot;promoted&quot;))
library(gmodels)
CrossTable(x = workaccident, y = leave_or_not, digits=3, max.width = 5, prop.r=TRUE,prop.chisq=FALSE, prop.c=FALSE,format=c(&quot;SPSS&quot;))
</code></pre><p> Total Observations in Table:  14999<br>  |Cell Contents<br>  |————————-|<br>  |                   Count |<br>  |             Row Percent |<br>  |          Column Percent |<br>  |           Total Percent |<br>  |————————-|</p>
<table>
<thead>
<tr>
<th>work accident</th>
<th>stay</th>
<th>leave</th>
<th>Row Total</th>
</tr>
</thead>
<tbody>
<tr>
<td>never happened</td>
<td>9428</td>
<td>3402</td>
<td>12830</td>
</tr>
<tr>
<td></td>
<td>73.484%</td>
<td>26.516%</td>
<td>85.539%</td>
</tr>
<tr>
<td></td>
<td>62.858%</td>
<td>22.682%</td>
<td></td>
</tr>
<tr>
<td>—————</td>
<td>———–</td>
<td>———–</td>
<td>———–</td>
</tr>
<tr>
<td>happened</td>
<td>2000</td>
<td>169</td>
<td>2169</td>
</tr>
<tr>
<td></td>
<td>92.208%</td>
<td>7.792%</td>
<td>14.461%</td>
</tr>
<tr>
<td></td>
<td>13.334%</td>
<td>1.127%</td>
<td></td>
</tr>
<tr>
<td>—————</td>
<td>———–</td>
<td>———–</td>
<td>———–</td>
</tr>
<tr>
<td>Column Total</td>
<td>11428</td>
<td>3571</td>
<td>14999</td>
</tr>
<tr>
<td>—————</td>
<td>———–</td>
<td>———–</td>
<td>———–</td>
</tr>
</tbody>
</table>
<pre><code>CrossTable(x = promotion, y = leave_or_not, digits=3, max.width = 5, prop.r=TRUE,prop.t=TRUE,prop.chisq=FALSE, prop.c=TRUE,format=c(&quot;SPSS&quot;))
</code></pre><p> Total Observations in Table:<br>   |                  leave_or_not                   |<br>   |  promotion  |     stay  |    leave  | Row Total |<br>   |————-|———–|———–|———–|<br>   |not promoted |   11128   |   3552    |    14680  |<br>   |             |   75.804% |   24.196% |   97.873% |<br>   |             |   97.375% |   99.468% |           |<br>   |             |   74.192% |   23.682% |           |<br>   |————-|———–|———–|———–|<br>   |   promoted  |    300    |    19     |    319    |<br>   |             |   94.044% |    5.956% |    2.127% |<br>   |             |    2.625% |    0.532% |           |<br>   |             |    2.000% |    0.127% |           |<br>   |————-|———–|———–|———–|<br>   |Column Total |    11428  |     3571  |    14999  |<br>   |             |   76.192% |   23.808% |           |<br>   |————-|———–|———–|———–|<br><br></p>
<p>Here it’s much clearer. On average valuable employees that left weren’t satisfied, had higher yearly evaluation of performance, worked on many projects, spent more hours in the company each month，been less likely to experience work accident but weren’t promoted. What’s more,the variance of these attributes for those who left is larger than those who didn’t. This might indicate the company lost some outstanding and poor employees but the mediocre tend to stay.</p>
<p><br></p>
<p><hr><br><br></p>
<h2 id="Deep-Insights"><a href="#Deep-Insights" class="headerlink" title="Deep Insights"></a>Deep Insights</h2><p>Here we begin to use some machine learning methods to analyze the specific prediction problem which employee will leave given his or her working performance.<br>Firstly we seperate the whole dataset into three parts, training data (60%),validation data(20%) and test data (20%). Stratified sampling is prefered here.<br>To compare the performance of each method, we use Kappa statistic and prediction accuracy. Also, in order to achieve the best performance, we apply cross-validation to minimize the influence of over-fitting existed in the training data. </p>
<h2 id="1-Logistic-Regression"><a href="#1-Logistic-Regression" class="headerlink" title="1.Logistic Regression"></a>1.Logistic Regression</h2><p>Logistic regression, as the most basic solution, will give us the first impression which attribute is significant and rough prediction which employee will leave.<br>|                     predicted condition             |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2113  |      172  |     2285  |<br>|                 |   70.457% |    5.735% |           |<br>|—————–|———–|———–|———–|<br>|               1 |      472  |      242  |      714  |<br>|                 |   15.739% |    8.069% |           |<br>|—————–|———–|———–|———–|<br>|    Column Total |     2585  |      414  |     2999  |<br>|—————–|———–|———–|———–|<br>The confusion matrix and the accuracy of the logistics model show somewhat satisfactory result. Kappa is about 31%, which seems a little poor. But after all it’s a very simple<br>model and give the reasonable results.</p>
<h2 id="2-Decision-Tree"><a href="#2-Decision-Tree" class="headerlink" title="2. Decision Tree"></a>2. Decision Tree</h2><pre><code>ctrl &lt;- trainControl(method = &quot;cv&quot;, number = 10,selectionFunction = &quot;oneSE&quot;)
grid &lt;- expand.grid(.model = c(&quot;tree&quot;,&quot;rules&quot;),.trials = c(1, 5, 10, 15, 20, 25, 30, 35),.winnow =c(TRUE,FALSE))
cart&lt;- train(left_or_not ~ ., data = trainprocessdata, method = &quot;C5.0&quot;,metric = &quot;Kappa&quot;,trControl = ctrl,tuneGrid = grid)
ggplot(cart) + theme_bw()
</code></pre><p><img src="/2017/03/24/HR data analysis/HR data/decisiontree.png" alt="plot 6"><br>We choose trial=10 and rules=false for the simple reason that this makes model simplest while at the same time doesn’t show much difference in Kappa performance from other combinations of parameter.</p>
<pre><code>result=C5.0(left_or_not~.,data=trainprocessdata,trials=10,rules=FALSE)
predictresult=predict(result,testprocessdata)
mean(predictresult==testprocessdata$left_or_not)
##get prediction accuracy=0.9836
kappa &lt;- kappa2(data.frame(testprocessdata$left_or_not, predictresult))$value
kappa
##get kappa statistics=0.954371
CrossTable(testprocessdata$left_or_not,predictresult,prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,dnn = c(&apos;actual condition&apos;, &apos;predicted condition&apos;),format=c(&quot;SPSS&quot;))
</code></pre><p>|                   predicted condition               |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2274  |       11  |     2285  |<br>|                 |   75.825% |    0.367% |           |<br>|—————–|———–|———–|———–|<br>|               1 |       38  |      676  |      714  |<br>|                 |    1.267% |   22.541% |           |<br>|—————–|———–|———–|———–|<br>|    Column Total |     2312  |      687  |     2999  |<br>|—————–|———–|———–|———–|</p>
<pre><code>vrimp=varImp(result)
vrimp[,&quot;name&quot;]=c(&quot;satisf_level&quot;,&quot;last_eval&quot;,&quot;num_proj&quot;, &quot;ave_mon_hrs&quot;,&quot;promo_last_5yrs&quot;,&quot;time_spend&quot;,&quot;salary&quot;,&quot;department&quot;,&quot;work_accid&quot;)
barplot(vrimp$Overall[order(vrimp$Overall, decreasing = TRUE)],names.arg=vrimp$name,ylab=&quot;importance&quot;,ylim = c(0, 100), main = &quot;Variables Relative Importance&quot;,col = &quot;lightblue&quot;)
</code></pre><p><img src="/2017/03/24/HR data analysis/HR data/treeimp.png" alt="plot 7"><br>Decision tree provides us a better method to estimate the importance of each attribute and predict employee’s action. Here we use C5.0 algorithm in that it shows superiority over other decision tree algorithem in accuracy.<br>We can see from the variable importance histogram that satisfaction level, last evaluation, number of projects and average working hour rank the highest in deciding whether employees will leave.<br>The confusion matrix and the accuracy of the decision tree model show much better result than logistic regression. Accuracy is about 98% and Kappa is about 95%.</p>
<h2 id="3-Bagging-Technique"><a href="#3-Bagging-Technique" class="headerlink" title="3.Bagging Technique"></a>3.Bagging Technique</h2><p>Bagging method is a little bit complex than decision because it takes the subset of the original train dataset many times (breed many independent trees) and then rank the frequency of each attribute that appears in each tree to decide which one is more essential. </p>
<pre><code>set.seed(5303)
bagmodel=train(left_or_not ~ ., data =trainprocessdata, method = &quot;treebag&quot;,trControl = ctrl)
bagprediction=predict(bagmodel,testprocessdata)
mean(bagprediction == testprocessdata$left_or_not)
[1] 0.9916639
kappa &lt;- kappa2(data.frame(testprocessdata$left_or_not, bagprediction))$value
kappa
[1] 0.9770115
CrossTable(testprocessdata$left_or_not,bagprediction,prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,dnn = c(&apos;actual condition&apos;, &apos;predicted condition&apos;),format=c(&quot;SPSS&quot;))
</code></pre><p>|                 | predicted condition               |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2273  |       12  |     2285  |<br>|                 |   75.792% |    0.400% |           |<br>|—————–|———–|———–|———–|<br>|               1 |       13  |      701  |      714  |<br>|                 |    0.433% |   23.374% |           |<br>|—————–|———–|———–|———–|<br>|    Column Total |     2286  |      713  |     2999  |<br>|—————–|———–|———–|———–|<br>Bagging method is almost perfect in predicting employee working condition compared with decision tree. Its accuracy reaches 99% and Kappa statistic is about 98%.</p>
<h2 id="4-Adaboost"><a href="#4-Adaboost" class="headerlink" title="4. Adaboost"></a>4. Adaboost</h2><p>Boosting technique is also a derivation of decision tree. It originates from several weak classifiers containing only the subset of all predictors. Then it gradually increases the weight of those classifiers who make the wrong prediction of output variable and trains them to be strong and accurate classifier. Adaboost is one of a powerful algorithm among boosting method.</p>
<pre><code>set.seed(5303)
ctrl &lt;- trainControl(method = &quot;cv&quot;, number = 10,selectionFunction = &quot;oneSE&quot;)
Grid &lt;- expand.grid(maxdepth=10,nu=0.1,iter=50)
adamodel &lt;- train(left_or_not~., data=trainprocessdata,method = &quot;ada&quot;, trControl = ctrl,tuneGrid=Grid,metric = &quot;Accuracy&quot;,preProc = c(&quot;center&quot;, &quot;scale&quot;))
adaprediction=predict(adamodel,testprocessdata)
mean(adaprediction == testprocessdata$left_or_not)
[1] 0.9873291
kappa &lt;- kappa2(data.frame(testprocessdata$left_or_not, adaprediction))$value
kappa
[1] 0.9648031
CrossTable(testprocessdata$left_or_not,adaprediction,prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,dnn = c(&apos;actual condition&apos;, &apos;predicted condition&apos;),format=c(&quot;SPSS&quot;))
</code></pre><p>|                 | predicted condition               |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2274  |       11  |     2285  |<br>|                 |   75.825% |    0.367% |           |<br>|—————–|———–|———–|———–|<br>|               1 |       27  |      687  |      714  |<br>|                 |    0.900% |   22.908% |           |<br>|—————-=|———–|———–|———–|<br>|    Column Total |     2301  |      698  |     2999  |<br>|—————–|———–|———–|———–|</p>
<p>The result of accuracy and Kappa proves that Adaboost performs also very well but slightly worse than bagging.</p>
<h2 id="5-Random-Forest"><a href="#5-Random-Forest" class="headerlink" title="5. Random Forest"></a>5. Random Forest</h2><p>Random forest is the combination of decision tree, bagging and boosting. Like bagging, it is also the aggregate of each independent tree composed of the subset of data. Like boosting, it uses the subset of all predictors. </p>
<pre><code>set.seed(5303)
rfranges &lt;- list(ntree = c(500, 1000, 1500), mtry = 2:6)
rftune &lt;- tune(randomForest,left_or_not~ ., data =trainprocessdata, ranges = rfranges)
rftune$best.parameters
rfbest &lt;- rftune$best.model
rfpredictions &lt;- predict(rfbest, testprocessdata)
mean(rfbestpredictions==testprocessdata$left_or_not)
[1] 0.9756586
kappa &lt;- kappa2(data.frame(testprocessdata$left_or_not, rfbestpredictions))$value
kappa
[1] 0.9323521
varImpPlot(rfbest,type=2)
</code></pre><p><img src="/2017/03/24/HR data analysis/HR data/rforest.png" alt="plot 8"></p>
<pre><code>CrossTable(testprocessdata$left_or_not,rfpredictions,prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,dnn = c(&apos;actual condition&apos;, &apos;predicted condition&apos;),format=c(&quot;SPSS&quot;))
</code></pre><p>|                 | predicted condition               |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2281  |        4  |     2285  |<br>|                 |   76.059% |    0.133% |           |<br>|—————–|———–|———–|———–|<br>|               1 |       13  |      701  |      714  |<br>|                 |    0.433% |   23.374% |           |<br>|—————–|———–|———–|———–|<br>|    Column Total |     2294  |      705  |     2999  |<br>|—————–|———–|———–|———–|</p>
<p>Random forest provides a good enough result (97% prediction accuracy and 93% Kappa) although it doesn’t seem as good as bagging and boosting.</p>
<h2 id="6-Neural-Network"><a href="#6-Neural-Network" class="headerlink" title="6. Neural Network"></a>6. Neural Network</h2><p>Here we applied the most widely used neural network model is the single-hidden-layer, feedforwardneural network mainly for computation convenience.</p>
<pre><code>set.seed(5303)
ctrl &lt;- trainControl(method = &quot;cv&quot;, number = 10,selectionFunction = &quot;oneSE&quot;)
nnetgrid&lt;- expand.grid(.decay = c(0.1, 0.01),.size = c(10,12,14,16,18))
nnetfit &lt;- train(left_or_not ~ ., data =trainprocessdata, method = &quot;nnet&quot;,maxit = 2000,metric = &quot;Accuracy&quot;,trControl = ctrl, tuneGrid =nnetgrid, trace = F, MaxNWts = 10000)
ggplot(nnetfit) + theme_bw()
</code></pre><p><img src="/2017/03/24/HR data analysis/HR data/neuralnetwork.png" alt="plot 8"></p>
<p>size=12 and decay=0.1 seems to be an appropriate combination</p>
<pre><code>nnetresult=nnet(left_or_not~.,data=trainprocessdata,size=12,maxit=2000,decay=0.1)
nnetpredict&lt;- predict(nnetresult,testprocessdata,type= &quot;class&quot;)
mean(nnetpredict == testprocessdata$left_or_not)
[1] 0.9643214
kappa &lt;- kappa2(data.frame(testprocessdata$left_or_not, nnetpredict))$value
kappa
[1] 0.9017038
CrossTable(testprocessdata$left_or_not,nnetpredict,prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,dnn = c(&apos;actual condition&apos;, &apos;predicted condition&apos;),format=c(&quot;SPSS&quot;))
</code></pre><p>|                 |  predicted condition              |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2231  |       54  |     2285  |<br>|                 |   74.391% |    1.801% |           |<br>|—————–|———–|———–|———–|<br>|               1 |       53  |      661  |      714  |<br>|                 |    1.767% |   22.041% |           |<br>|—————–|———–|———–|———–|<br>|    Column Total |     2284  |      715  |     2999  |<br>|—————–|———–|———–|———–|</p>
<p>Neural network’s performance is not as good as the methods as we used before except logistic regression. If we increase the number of node or hidden layer, the performance will improve at the risk of over-fitting.</p>
<h2 id="7-SVM"><a href="#7-SVM" class="headerlink" title="7.SVM"></a>7.SVM</h2><p>SVM provides us a conceptual framework that is quite irrelevant to the statistical learning procedure but it is actually very useful in classification problem.</p>
<pre><code>set.seed(5303)
library(e1071)
svmtune &lt;- tune(svm,left_or_not~ ., data =trainprocessdata,kernel = &quot;radial&quot;, ranges = list(cost = c(0.01, 0.1, 1, 10, 100),
gamma = c(0.01, 0.05, 0.1, 0.5, 1)))
svmtune
svmmodel &lt;- svmtune$best.model
svmpredict&lt;- predict(svmmodel,testprocessdata,type = &quot;class&quot;)
mean(svmpredict==testprocessdata$left_or_not)
[1] 0.9836612
kappa &lt;- kappa2(data.frame(testprocessdata$left_or_not, svmpredict))$value
kappa
[1] 0.9551154
CrossTable(testprocessdata$left_or_not,svmpredict,prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,dnn = c(&apos;actual condition&apos;, &apos;predicted condition&apos;),format=c(&quot;SPSS&quot;))
</code></pre><p>|                 | predicted condition               |<br>|actual condition |        0  |        1  | Row Total |<br>|—————–|———–|———–|———–|<br>|               0 |     2257  |       28  |     2285  |<br>|                 |   75.258% |    0.934% |           |<br>|—————–|———–|———–|———–|<br>|               1 |       21  |      693  |      714  |<br>|                 |    0.700% |   23.108% |           |<br>|—————–|———–|———–|———–|<br>|    Column Total |     2278  |      721  |     2999  |<br>|—————–|———–|———–|———–|</p>
<p>The accuracy and Kappa is approximate to the result of bagging and boosting, which shows its goodness.</p>
<p><br></p>
<p><hr><br><br></p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><center><br>Last updated on the 11/2015<br></center>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>

</div>

            
    
        <a href="http://zhongkai1991.github.io/2017/03/24/HR data analysis/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://zhongkai1991.github.io/2017/03/24/HR data analysis/">Comments</a>
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/03/26/svm/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    Support Vector Machine
                
            </div>
        </a>
    
    
        <a href="/2017/03/23/wine-quality-data-report/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">wine quality data report</div>
        </a>
    
</nav>


    
</article>


    
    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

</section>
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/03/26/svm/" class="thumbnail">
    
    
        <span style="background-image:url(/svm/sheep.png)" alt="Support Vector Machine" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/note/">note</a></p>
                            <p class="item-title"><a href="/2017/03/26/svm/" class="title">Support Vector Machine</a></p>
                            <p class="item-date"><time datetime="2017-03-25T16:00:00.000Z" itemprop="datePublished">2017-03-26</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/03/24/HR data analysis/" class="thumbnail">
    
    
        <span style="background-image:url(/images/giphy2.gif)" alt="HR data analysis" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/03/24/HR data analysis/" class="title">HR data analysis</a></p>
                            <p class="item-date"><time datetime="2017-03-23T23:48:16.409Z" itemprop="datePublished">2017-03-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/03/23/wine-quality-data-report/" class="thumbnail">
    
    
        <span style="background-image:url(/images/wine.gif)" alt="wine quality data report" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/03/23/wine-quality-data-report/" class="title">wine quality data report</a></p>
                            <p class="item-date"><time datetime="2017-03-23T05:24:44.000Z" itemprop="datePublished">2017-03-23</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/03/22/hello-world/" class="thumbnail">
    
    
        <span style="background-image:url(/images/china-great-wall.jpg)" alt="Hello World" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/03/22/hello-world/" class="title">Hello World</a></p>
                            <p class="item-date"><time datetime="2017-03-21T17:23:00.835Z" itemprop="datePublished">2017-03-22</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/note/">note</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">4</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/R/">R</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-report/">data report</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/introduction/">introduction</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/Machine-Learning/" style="font-size: 10px;">Machine Learning</a> <a href="/tags/R/" style="font-size: 10px;">R</a> <a href="/tags/data-report/" style="font-size: 10px;">data report</a> <a href="/tags/introduction/" style="font-size: 10px;">introduction</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
                    <li>
                        <a href="https://choux130.github.io/myblog/">Yin-Ting Chou</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2017 Kai Zhong<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_config = function () {
        
            this.page.url = 'http://zhongkai1991.github.io/2017/03/24/HR data analysis/';
        
        this.page.identifier = 'HR data analysis';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'hexo-theme-icarus' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML.js"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>